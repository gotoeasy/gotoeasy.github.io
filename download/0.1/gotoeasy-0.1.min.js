/*!
* gotoEasy 0.1 (http://gotoeasy.github.io)
* (c) 2016 Zhang Ming
* Licensed under the MIT license
*/
(function(H,l){function ha(a){if(!a)return ia(e);var b=e;if(C(a)){var c=Object.keys(b),d;for(d in a)0<=c.indexOf(d)&&(b[d]=a[d])}ja=e.debugMode;D=e.dataKeyFnId;v=e.dataKeyFnParent;I=e.dataKeyFnRoot;w=e.domAttrBind;x=e.bindKeyField;J=e.bindKeyValue;S=e.bindKeyInnerText;ka=e.bindKeyInnerHtml;la=e.bindKeyOptions;ma=e.bindKeyReadonly;na=e.bindKeyDisabled;oa=e.bindKeyVisible;T=e.bindKeyChecked;pa=e.bindKeyStyle;qa=e.bindKeyClass;ra=e.bindKeyForeach;sa=e.bindKeyWith;ta=e.bindKeyIf;U=e.bindKeyClick;ua=e.bindRefRoot;
va=e.bindRefParent;V=e.eventDataChage;E=e.eventUpdateView;PREFIX_DATA_UID=e.prefixDataUid;return ia(e)}function F(a){F[a]=F[a]||1;return a+F[a]++}function W(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function wa(a){return K(a)?JSON.stringify(a):JSON.parse(a)}function y(a){return Array.isArray&&Array.isArray(a)||a instanceof Array||"[object Array]"==Object.prototype.toString.call(a)}function C(a){return a&&Object.prototype.toString.call(a)===Ga}function K(a){return null!==a&&"object"===typeof a}function Ha(a,
b){return C(a)&&void 0!==a[b]}function ia(a){var b={},c;for(c in a)b[c]=a[c];return b}function Ia(a,b,c){var d=[];if(!b||0>b)b=0;if(!c||c>a.length)c=a.length;if(b>=c)return d;for(;b<c;b++)d.push(a[b]);return d}function n(a,b){for(var c=0;c<a.length&&!1!==b(a[c],c);c++);}function Ja(a,b,c){try{return b.apply(a,c)}catch(d){Ka(arguments,d)}}function Ka(){xa("warn",G.call(arguments),ja)}function X(){xa("error",G.call(arguments),1)}function xa(a,b,c){if(c){c=[];for(var d=0;d<b.length;d++)c.push("_["+d+
"]");c="console."+a+"("+c.join(",");c+=")";try{(new Function("_",c))(b)}catch(f){console.warn(a,b,f)}}}function Y(a,b,c,d){if(a[D]){var f=a[b];if(d||K(c)||c!==f)if(z(c,a,b),a[b]=c,L(V,a,b,c,f),y(a))for(k in b=a[v](),b)b[k]===a&&ya(E,b,k,c,f);else ya(E,a,b,c,f)}else a[b]=c}function q(a){return a&&a[D]()}function z(a,b,c){if(K(a))if(La(a,b),C(a))for(var d in a)z(a[d],a,d);else if(y(a)){for(d=0;d<a.length;d++)z(a[d],a,d);a[v]()&&Ma(a,b,c)}}function La(a,b){var c=a[D]?q(a):F(Na),d=b?q(b):null,f=b?q(b[I]()):
c;t[c]=a;a[D]=function(){return c};a[v]=function(){return t[d]};a[I]=function(){return t[f]};a.set=function(a,b,c){Y(this,a,b,c)};a.get=function(a,b){var c=this[a];return void 0===c?b:c}}function Ma(a,b,c){a.x||(n("push pop shift unshift splice sort reverse".split(" "),function(d){var f=a[d];a[d]=function(){var e=a.length,h=f.apply(a,arguments);if("push"==d)for(var p=e;p<h;p++)z(a[p],a,p);else if("unshift"==d)for(p=0;p<h-e;p++)z(a[p],a,p);L(V+" "+E,b,c,a);return h}}),a.x=1)}function M(a,b,c,d){if(Ha(a,
b))return c&&c.push(q(a)+"-"+b),a[b];var f=q(a)+"#"+b;if(c||!A[f]){var e=[],h=b.replace(Oa,function(a){var b="{"+e.length+"}";e.push(a);return b}),h=h.replace(Pa,function(b){if(/^\d+$/g.test(b)||"true"==b||"false"==b||"null"==b||"]"===b.slice(0,1))return b;b=b.split(Z).join(Z).split(aa).join(aa);b=b.split(va).join(Z).split(ua).join(aa);if(c){var d;a:{var e="return _."+b;if(d=ba(e)){d=d(a);if(0>e.indexOf(".")){d=q(a)+"-"+e;break a}var f=e.split("."),e=f.pop();if(K(d)){d=q(d[v]())+"-"+e;break a}if(d=
ba(f.join("."))){d=q(d(a))+"-"+e;break a}}d=void 0}d&&c.push(d)}return"_."+b});for(i=0;i<e.length;i++)h=h.replace("{"+i+"}",e[i]);A[f]=A[f]||ba("return "+h)}if(d)return A[f];if(!c)try{return A[f](a)}catch(p){X("#2",A[f],a,b,p)}}function ba(a){try{return new Function("_",a)}catch(b){X("#1",a)}}function ca(a,b,c){if(a._bindInfo)return wa(a._bindInfo);a=da(a.getAttribute(w));if(!a)return 0;a._dataid=q(b);if(c)for(var d in a)if("_dataid"!=d&&d!=x&&d!=U){var e=[];M(b,a[d],e);n(e,function(a){c.push(a)})}return a}
function da(a){var b={},c;if(!a)return null;a=a.split(",");n(a,function(a){c=a.split(":");b[W(c[0]).toLowerCase()]=W(a.substring(a.indexOf(":")+1))});return b}function za(a,b){var c=[],d=ca(a,b,c);n(c,function(b){if(Qa)if(a.className){var c=a.className.split(" ");0<=c.indexOf(b)||(c.push(b),a.className=c.join(" "))}else a.className=b;else a.classList.contains(b)||a.classList.add(b)});d[x]||(c=d[J]||d[S],void 0!==b[c]&&(d[x]=c));a._bindInfo=wa(d)}function Aa(a,b){for(var c=a.querySelectorAll(b||N),
d=Ra(Ba),e=[],m=0;m<d.length;m++)e.push("["+w+"*="+d[m]+"]");n(c,function(a){var b=da(a.getAttribute(w)),c=0,m;for(m in b)0<=d.indexOf(m)&&(c=1);if(c){for(b=0;b<d.length;b++)Sa(a,e[b],d[b])&&Aa(a);var g=l.createDocumentFragment(),b=Ia(a.childNodes);n(b,function(a){g.appendChild(a.cloneNode(!0))});b=F(Ta);l[b]=g;a.setAttribute("_template",b);O(a)}})}function Sa(a,b,c){a=a.querySelectorAll(b);for(b=0;b<a.length;b++)if(da(a[b].getAttribute(w))[c])return!0;return!1}function Ua(a,b){Aa(b||l);var c=(b||
l).querySelectorAll(N);n(c,function(b){za(b,a)})}function Va(a){a=(a||l).querySelectorAll(N);n(a,function(a){ea(a)})}function g(a,b,c,d,e,m){var h={};h[fa]=a;h[ga]=b;h.o=c||0;h[Ba]=!!d;h[Ca]=!!e;h.p=m;u[a]=h;Wa.push(a);P=[];for(k in u)P.push(u[k]);P.sort(function(a,b){return a.o==b.o?0:a.o<b.o?1:-1})}function Ra(a){var b=[],c;for(c in u)a?u[c][a]&&b.push(c):b.push(c);return b}function Da(a,b){var c=[],d=a.getAttribute("style"),e;if(d){for(var d=d.split(";"),m=0;m<d.length;m++)e=d[m].split(":"),e=
W(e[0]).toLowerCase(),0>b.indexOf(e)&&c.push(d[m]);d=c.join(";");a.setAttribute("style",d);return d}}function Q(a,b,c){var d;c?(d=l.createDocumentFragment(),y(a)&&0<a.length&&n(a,function(a){if(a){var c;a=Q(a,b);for(var e=0;e<a.childNodes.length;e++)"TBODY"==a.childNodes[e].tagName&&(c=a.childNodes[e]);if(c)for(e=0;e<c.childNodes.length;e++)d.appendChild(c.childNodes[e]);else d.appendChild(a)}})):(d=l[b.getAttribute("_template")].cloneNode(!0),n(d.querySelectorAll(N),function(b){za(b,a);ea(b)}));
return d}function ea(a,b,c){b=b||ca(a);n(P,function(d){function e(){try{M(g,f,0,1)(g)}catch(b){X("#3",a,f,b)}}var f=b[d[fa]];if(f&&!(c&&0>f.indexOf(c))){var g=t[b._dataid];if(d[Ca])Ea(d[fa],e,a);else{var g=t[b._dataid],l=M(g,f);d[ga](a,l,g,f)}}});for(var d in b)if(!u[d]&&"_dataid"!=d){var e=b[d];if(c&&0>e.indexOf(c))break;e=M(t[b._dataid],e);u["*"][ga](a,d,e)}}function Xa(a,b){for(var c=l.querySelectorAll("."+q(a)+"-"+b),d=0;d<c.length;d++)ea(c[d],"",b)}function Ya(a){a=a.target;var b=ca(a);if(b){var c=
t[b._dataid],b=b[x]||b[J]||b[T],d=c[b];"checkbox"==a.type?y(d)?a.checked?0>d.indexOf(a.value)&&d.push(a.value):0<=d.indexOf(a.value)&&d.splice(d.indexOf(a.value),1):d=a.value:d=a.value;Y(c,b,d)}}function Ea(a,b,c){c.addEventListener?c.addEventListener(a,b,!1):c.attachEvent?c.attachEvent("on"+a,b):c["on"+a]=b}function O(a){try{a.innerHTML=""}catch(b){for(;a.firstChild;)a.removeChild(a.firstChild)}}function Fa(a,b){a&&"function"==typeof b&&b.constructor==Function&&a.replace(R,function(a,d){(B[a]=B[a]||
[]).push(b)})}function L(a,b){var c=G.call(arguments,1);a.replace(R,function(a){a=B[a]||[];for(var e=0;e<a.length;e++)Ja(b,a[e],c)})}function ya(a,b,c){isNaN(a);var d=isNaN(a)?G.call(arguments,0):G.call(arguments,1);Za(function(){L.apply(null,d)},a)}var Qa=H==l&&l!=H;Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0;c<this.length;c++)if(this[c]===a)return c;return-1});var e={},ja=e.debugMode=1,D=e.dataKeyFnId="_$id",v=e.dataKeyFnParent="_$parent",I=e.dataKeyFnRoot="_$root",
w=e.domAttrBind="data-bind",x=e.bindKeyField="field",J=e.bindKeyValue="value",S=e.bindKeyInnerText="text",ka=e.bindKeyInnerHtml="html",la=e.bindKeyOptions="options",ma=e.bindKeyReadonly="readonly",na=e.bindKeyDisabled="disabled",oa=e.bindKeyVisible="visible",T=e.bindKeyChecked="checked",pa=e.bindKeyStyle="style",qa=e.bindKeyClass="class";e.bindKeyTemplate="template";var ra=e.bindKeyForeach="foreach",sa=e.bindKeyWith="with",ta=e.bindKeyIf="if",U=e.bindKeyClick="click",ua=e.bindRefRoot="$root",va=e.bindRefParent=
"$parent",V=e.eventDataChage="datachange",E=e.eventUpdateView="updaueview";e.eventArrayChage="arraychange";var Na=e.uidPrefixData="duid-",Ta=e.uidPrefixTemplate="tuid-",aa=I+"()",Z=v+"()",Ga="[object Object]",N="["+w+"]",G=Array.prototype.slice,Za=setTimeout,t={},Oa=/(['"])[^'"]*\1/g,Pa=/([\w$_\.\[\]]+)/g,A={},u={},P=[],Wa=[],fa="k",ga="f",Ba="t",Ca="e";g("*",function(a,b,c){c=(new Option(null==c?"":c)).innerHTML.replace(/"/g,"&quot;");a.setAttribute(b,c)});g(J,function(a,b,c,d){a.value=null==b?"":
b});g(ma,function(a,b,c,d){a.readonly=!!b});g(na,function(a,b,c,d){a.disabled=!!b},5);g(T,function(a,b,c,d){y(b)?a.checked=0<=b.indexOf(a.value):a.checked=b==a.value});g(oa,function(a,b,c,d){Da(a,["visibility","display"]);b?a.style.visibility="visible":a.style.display="none"},5);g(pa,function(a,b,c){Da(a,["visibility","display"]);b?a.style.visibility="visible":a.style.display="none"},5,0,0,"; =");g(qa,function(a,b,c,d){console.warn("TODO: class render")});g(S,function(a,b,c,d){a.textContent=null==
b?"":b});g(ka,function(a,b,c,d){a.innerHTML=null==b?"":b});g(x,function(){});g(la,function(a,b,c,d){a.length=0;if(null!=b&&!C(b)){var e=a.options;y(b)||(b=b.split(","));n(b,function(a){C(a)?e[e.length]=new Option(a.text,a.value):e[e.length]=null==a?new Option("",""):new Option(a,a)})}},5);g(U,null,0,0,1);g(ra,function(a,b,c,d){O(a);b&&b.length&&a.appendChild(Q(b,a,!0))},7,1);g(sa,function(a,b,c,d){O(a);a.appendChild(Q(b,a))},8,1);g(ta,function(a,b,c,d){O(a);if(b)a.appendChild(Q(c,a));else return!1},
9,1);var R=/\S+/g,B={},r={};r.settings=ha;r.bind=function(a,b,c){c&&ha(c);z(a);b=b?l.querySelector(b):l;Ua(a,b);Va(b);Fa(E,Xa);Ea("change",Ya,l)};r.set=Y;r.on=Fa;r.off=function(a,b){a&&"*"!=a?b?a.replace(R,function(a){a=B[a];for(var d=0;d<a.length;d++)b===a[d]&&a.splice(d--,1)}):a.replace(R,function(a){B[a]=[]}):B={}};r.trigger=L;"function"===typeof define&&define.amd?define(function(){return r}):H.gotoEasy=H.$easy=r})(window,document);