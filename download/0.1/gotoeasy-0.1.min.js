/*!
* gotoEasy 0.1 (http://gotoeasy.github.io)
* (c) 2016 Zhang Ming
* Licensed under the MIT license
*/
(function(J,p){function ja(a){if(!a)return ka(e);var b=e;if(E(a)){var c=Object.keys(b),d;for(d in a)0<=c.indexOf(d)&&(b[d]=a[d])}T=e.debugMode;F=e.dataKeyFnId;v=e.dataKeyFnParent;K=e.dataKeyFnRoot;w=e.domAttrBind;x=e.bindKeyField;L=e.bindKeyValue;U=e.bindKeyInnerText;la=e.bindKeyInnerHtml;ma=e.bindKeyOptions;na=e.bindKeyReadonly;oa=e.bindKeyDisabled;pa=e.bindKeyVisible;V=e.bindKeyChecked;qa=e.bindKeyStyle;ra=e.bindKeyClass;sa=e.bindKeyForeach;ta=e.bindKeyWith;ua=e.bindKeyIf;W=e.bindKeyClick;va=e.bindRefRoot;
wa=e.bindRefParent;X=e.eventDataChage;G=e.eventUpdateView;PREFIX_DATA_UID=e.prefixDataUid;return ka(e)}function H(a){H[a]=H[a]||1;return a+H[a]++}function I(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function xa(a){return M(a)?JSON.stringify(a):JSON.parse(a)}function y(a){return Array.isArray&&Array.isArray(a)||a instanceof Array||"[object Array]"==Object.prototype.toString.call(a)}function E(a){return a&&Object.prototype.toString.call(a)===Ga}function M(a){return null!==a&&"object"===typeof a}function Ha(a,
b){return E(a)&&void 0!==a[b]}function ka(a){var b={},c;for(c in a)b[c]=a[c];return b}function Ia(a,b,c){var d=[];if(!b||0>b)b=0;if(!c||c>a.length)c=a.length;if(b>=c)return d;for(;b<c;b++)d.push(a[b]);return d}function q(a,b){for(var c=0;c<a.length&&!1!==b(a[c],c);c++);}function Ja(a,b,c){try{return b.apply(a,c)}catch(d){Ka(arguments,d)}}function La(){Y("log",z.call(arguments),T)}function Ka(){Y("warn",z.call(arguments),T)}function Z(){Y("error",z.call(arguments),1)}function Y(a,b,c){if(c){c=[];for(var d=
0;d<b.length;d++)c.push("_["+d+"]");c="console."+a+"("+c.join(",");c+=")";try{(new Function("_",c))(b)}catch(f){console.warn(a,b,f)}}}function aa(a,b,c,d){if(a[F]){var f=a[b];if(d||M(c)||c!==f)if(A(c,a,b),a[b]=c,N(X,a,b,c,f),y(a))for(k in b=a[v](),b)b[k]===a&&ya(G,b,k,c,f);else ya(G,a,b,c,f)}else a[b]=c}function r(a){return a&&a[F]()}function A(a,b,c){if(M(a))if(Ma(a,b),E(a))for(var d in a)A(a[d],a,d);else if(y(a)){for(d=0;d<a.length;d++)A(a[d],a,d);a[v]()&&Na(a,b,c)}}function Ma(a,b){var c=a[F]?
r(a):H(Oa),d=b?r(b):null,f=b?r(b[K]()):c;B[c]=a;a[F]=function(){return c};a[v]=function(){return B[d]};a[K]=function(){return B[f]};a.set=function(a,b,c){aa(this,a,b,c)};a.get=function(a,b){var c=this[a];return void 0===c?b:c}}function Na(a,b,c){a.x||(q("push pop shift unshift splice sort reverse".split(" "),function(d){var f=a[d];a[d]=function(){var e=a.length,h=f.apply(a,arguments);if("push"==d)for(var n=e;n<h;n++)A(a[n],a,n);else if("unshift"==d)for(n=0;n<h-e;n++)A(a[n],a,n);N(X+" "+G,b,c,a);return h}}),
a.x=1)}function m(a,b,c,d){if(Ha(a,b))return c&&c.push(r(a)+"-"+b),a[b];var f=r(a)+"#"+b;if(c||!C[f]){var e=[],h=b.replace(Pa,function(a){var b="{"+e.length+"}";e.push(a);return b}),h=h.replace(Qa,function(b){if(/^\d+$/g.test(b)||"true"==b||"false"==b||"null"==b||"]"===b.slice(0,1))return b;b=b.split(ba).join(ba).split(ca).join(ca);b=b.split(wa).join(ba).split(va).join(ca);if(c){var d;a:{var f="return _."+b;if(d=da(f)){d=d(a);if(0>f.indexOf(".")){d=r(a)+"-"+f;break a}var e=f.split("."),f=e.pop();
if(M(d)){d=r(d[v]())+"-"+f;break a}if(d=da(e.join("."))){d=r(d(a))+"-"+f;break a}}d=void 0}d&&c.push(d)}return"_."+b});for(i=0;i<e.length;i++)h=h.replace("{"+i+"}",e[i]);C[f]=C[f]||da("return "+h)}if(d)return C[f];if(!c)try{return C[f](a)}catch(n){Z("#2",C[f],a,b,n)}}function da(a){try{return new Function("_",a)}catch(b){Z("#1",a)}}function ea(a,b,c){if(a._bindInfo)return xa(a._bindInfo);a=fa(a.getAttribute(w));if(!a)return 0;a._dataid=r(b);if(c)for(var d in a)if("_dataid"!=d&&d!=x&&d!=W)if("style"==
d)for(var f=a[d].split(";"),e=0,h;e<f.length;e++){h=f[e].split("=");var n=[];m(b,h[1],n);for(h=0;h<n.length;h++)c.push(n[h])}else for(n=[],m(b,a[d],n),e=0;e<n.length;e++)c.push(n[e]);return a}function fa(a){var b={},c;if(!a)return null;a=a.split(",");q(a,function(a){c=a.split(":");b[I(c[0]).toLowerCase()]=I(a.substring(a.indexOf(":")+1))});return b}function za(a,b){var c=[],d=ea(a,b,c);q(c,function(b){if(Ra)if(a.className){var c=a.className.split(" ");0<=c.indexOf(b)||(c.push(b),a.className=c.join(" "))}else a.className=
b;else a.classList.contains(b)||a.classList.add(b)});d[x]||(c=d[L]||d[U],void 0!==b[c]&&(d[x]=c));a._bindInfo=xa(d)}function Aa(a,b){for(var c=a.querySelectorAll(b||O),d=Sa(Ba),e=[],g=0;g<d.length;g++)e.push("["+w+"*="+d[g]+"]");q(c,function(a){var b=fa(a.getAttribute(w)),c=0,g;for(g in b)0<=d.indexOf(g)&&(c=1);if(c){for(b=0;b<d.length;b++)Ta(a,e[b],d[b])&&Aa(a);var m=p.createDocumentFragment(),b=Ia(a.childNodes);q(b,function(a){m.appendChild(a.cloneNode(!0))});b=H(Ua);p[b]=m;a.setAttribute("_template",
b);P(a)}})}function Ta(a,b,c){a=a.querySelectorAll(b);for(b=0;b<a.length;b++)if(fa(a[b].getAttribute(w))[c])return!0;return!1}function Va(a,b){Aa(b||p);var c=(b||p).querySelectorAll(O);q(c,function(b){za(b,a)})}function Wa(a){a=(a||p).querySelectorAll(O);q(a,function(a){ga(a)})}function l(a,b,c,d,e,g){g={};g[ha]=a;g[ia]=b;g.o=c||0;g[Ba]=!!d;g[Ca]=!!e;u[a]=g;Xa.push(a);Q=[];for(k in u)Q.push(u[k]);Q.sort(function(a,b){return a.o==b.o?0:a.o<b.o?1:-1})}function Sa(a){var b=[],c;for(c in u)a?u[c][a]&&
b.push(c):b.push(c);return b}function Da(a,b,c){var d=[],e=a.getAttribute("style"),g;if(e){for(var e=e.split(";"),h=0;h<e.length;h++)g=e[h].split(":"),g=I(g[0]).toLowerCase(),0>b.indexOf(g)&&d.push(e[h]);c&&d.push(c);e=d.join(";");a.setAttribute("style",e);return e}}function R(a,b,c){var d;c?(d=p.createDocumentFragment(),y(a)&&0<a.length&&q(a,function(a){if(a){var c;a=R(a,b);for(var e=0;e<a.childNodes.length;e++)"TBODY"==a.childNodes[e].tagName&&(c=a.childNodes[e]);if(c)for(e=0;e<c.childNodes.length;e++)d.appendChild(c.childNodes[e]);
else d.appendChild(a)}})):(d=p[b.getAttribute("_template")].cloneNode(!0),q(d.querySelectorAll(O),function(b){za(b,a);ga(b)}));return d}function ga(a,b,c){b=b||ea(a);q(Q,function(d){function e(){try{m(l,f,0,1)(l)}catch(b){Z("#3",a,f,l,b)}}var f=b[d[ha]],l=B[b._dataid];if(f&&!(c&&0>f.indexOf(c)))if(d[Ca])Ea(d[ha],e,a);else d[ia](a,l,f)});for(var d in b)if(!u[d]&&"_dataid"!=d){var e=b[d];c&&0>e.indexOf(c)||(e=m(B[b._dataid],e),u["*"][ia](a,d,e))}}function Ya(a,b){for(var c=p.querySelectorAll("."+r(a)+
"-"+b),d=0;d<c.length;d++)ga(c[d],"",b)}function Za(a){a=a.target;var b=ea(a);if(b){var c=b[x]||b[L]||b[V];if(null==c)La("[ignore datachange]",a);else{var b=B[b._dataid],d=b[c];"checkbox"==a.type?y(d)?a.checked?0>d.indexOf(a.value)&&d.push(a.value):0<=d.indexOf(a.value)&&d.splice(d.indexOf(a.value),1):d=a.checked?a.value:"":d=a.value;aa(b,c,d)}}}function Ea(a,b,c){c.addEventListener?c.addEventListener(a,b,!1):c.attachEvent?c.attachEvent("on"+a,b):c["on"+a]=b}function P(a){try{a.innerHTML=""}catch(b){for(;a.firstChild;)a.removeChild(a.firstChild)}}
function Fa(a,b){a&&"function"==typeof b&&b.constructor==Function&&a.replace(S,function(a,d){(D[a]=D[a]||[]).push(b)})}function N(a,b){var c=z.call(arguments,1);a.replace(S,function(a){a=D[a]||[];for(var e=0;e<a.length;e++)Ja(b,a[e],c)})}function ya(a,b,c){isNaN(a);var d=isNaN(a)?z.call(arguments,0):z.call(arguments,1);$a(function(){N.apply(null,d)},a)}var Ra=J==p&&p!=J;Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0;c<this.length;c++)if(this[c]===a)return c;return-1});
var e={},T=e.debugMode=1,F=e.dataKeyFnId="_$id",v=e.dataKeyFnParent="_$parent",K=e.dataKeyFnRoot="_$root",w=e.domAttrBind="data-bind",x=e.bindKeyField="field",L=e.bindKeyValue="value",U=e.bindKeyInnerText="text",la=e.bindKeyInnerHtml="html",ma=e.bindKeyOptions="options",na=e.bindKeyReadonly="readonly",oa=e.bindKeyDisabled="disabled",pa=e.bindKeyVisible="visible",V=e.bindKeyChecked="checked",qa=e.bindKeyStyle="style",ra=e.bindKeyClass="class";e.bindKeyTemplate="template";var sa=e.bindKeyForeach="foreach",
ta=e.bindKeyWith="with",ua=e.bindKeyIf="if",W=e.bindKeyClick="click",va=e.bindRefRoot="$root",wa=e.bindRefParent="$parent",X=e.eventDataChage="datachange",G=e.eventUpdateView="updaueview";e.eventArrayChage="arraychange";var Oa=e.uidPrefixData="duid-",Ua=e.uidPrefixTemplate="tuid-",ca=K+"()",ba=v+"()",Ga="[object Object]",O="["+w+"]",z=Array.prototype.slice,$a=setTimeout,B={},Pa=/(['"])[^'"]*\1/g,Qa=/([\w$_\.\[\]]+)/g,C={},u={},Q=[],Xa=[],ha="k",ia="f",Ba="t",Ca="e";l("*",function(a,b,c){c=(new Option(null==
c?"":c)).innerHTML.replace(/"/g,"&quot;");a.setAttribute(b,c)});l(L,function(a,b,c){b=m(b,c);a.value=null==b?"":b});l(na,function(a,b,c){b=m(b,c);a.readOnly=!!b});l(oa,function(a,b,c){b=m(b,c);a.disabled=!!b},5);l(V,function(a,b,c){b=m(b,c);y(b)?a.checked=0<=b.indexOf(a.value):a.checked=b==a.value});l(pa,function(a,b,c){b=m(b,c);Da(a,["visibility","display"]);b?a.style.visibility="visible":a.style.display="none"},5);l(qa,function(a,b,c){var d=c.split(";");c=[];for(var e=[],g=0,h;g<d.length;g++)h=
d[g].split("="),2==h.length&&(c.push(I(h[0]).toLowerCase()),e.push(I(h[1])));if(c.length){d=[];for(g=0;g<c.length;g++)d.push(c[g]+":"+m(b,e[g]));Da(a,c,d.join(";"))}},5);l(ra,function(a,b,c){m(b,c);console.warn("TODO: class render")});l(U,function(a,b,c){b=m(b,c);a.textContent=null==b?"":b});l(la,function(a,b,c){b=m(b,c);a.innerHTML=null==b?"":b});l(x,function(){});l(ma,function(a,b,c){b=m(b,c);a.length=0;if(null!=b&&!E(b)){var d=a.options;y(b)||(b=b.split(","),1==b.length&&(b=b[0].split(";")));q(b,
function(a){E(a)?d[d.length]=new Option(a.text,a.value):d[d.length]=null==a?new Option("",""):new Option(a,a)})}},5);l(W,null,0,0,1);l(sa,function(a,b,c){b=m(b,c);P(a);b&&b.length&&a.appendChild(R(b,a,!0))},7,1);l(ta,function(a,b,c){b=m(b,c);P(a);a.appendChild(R(b,a))},8,1);l(ua,function(a,b,c){c=m(b,c);P(a);if(c)a.appendChild(R(b,a));else return!1},9,1);var S=/\S+/g,D={},t={};t.settings=ja;t.bind=function(a,b,c){c&&ja(c);A(a);b=b?p.querySelector(b):p;Va(a,b);Wa(b);Fa(G,Ya);Ea("change",Za,p)};t.set=
aa;t.on=Fa;t.off=function(a,b){a&&"*"!=a?b?a.replace(S,function(a){a=D[a];for(var d=0;d<a.length;d++)b===a[d]&&a.splice(d--,1)}):a.replace(S,function(a){D[a]=[]}):D={}};t.trigger=N;"function"===typeof define&&define.amd?define(function(){return t}):J.gotoEasy=J.$easy=t})(window,document);