import{r as t,b as P,aj as U,c as T,k as V,h as n,g as a,e as r,w as q,l as F,j as u,O as G,f as H,$ as K,V as x,a7 as J,ak as Q,z as W,A as X,B as Y,C as Z,D as ee,x as oe,P as ne}from"./index-919bd748.js";/* empty css                   *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                     *//* empty css                         *//* empty css                *//* empty css                    */const ae=H("span",null,"确 定",-1),ie={__name:"RoleAuthMenuDrawer",setup(te,{expose:M}){const d=t(!1),i=t([]),l=t(),$=t(!1),m=t([]),D=t(""),h=t([]),p=t([]),f=t([]),E=t([]),b=e=>e.menuType=="2"?"c-is-page":null,B=()=>{const e=D.value,o=[],c=l.value.store.nodesMap;for(const s in c)c[s].isLeaf&&c[s].checked&&o.push(s);const y=o.join(",");K("/system/rolemenu/save",{roleId:e,menuIds:y}).then(s=>{if(!s.success)return x.info(s.message);x.info("操作成功！"),k()})},k=()=>{i.value=[],m.value=[],h.value=[],p.value=[],f.value=[],E.value=[],d.value=!1},I=e=>{D.value=e,N(e),d.value=!0};function N(e){K("/system/menu/rolemenu",{roleId:e}).then(o=>{o.success?(i.value=o.data,i.value.forEach(c=>C(c)),J(g)):x.error(o.message)})}function C(e){e.checked&&m.value.push(e.id),(e.children||[]).forEach(o=>C(o)),h.value.push(e.id),e.menuType=="1"&&p.value.push(e.id),e.menuType=="2"&&f.value.push(e.id),e.menuType=="3"&&E.value.push(e.id)}const g=()=>{const e=l.value.store.nodesMap;p.value.forEach(o=>e[o].expanded=!0),f.value.forEach(o=>e[o].expanded=!1)},R=()=>{const e=l.value.store.nodesMap;p.value.forEach(o=>e[o].expanded=!0),f.value.forEach(o=>e[o].expanded=!0)},A=()=>{const e=l.value.store.nodesMap;p.value.forEach(o=>e[o].expanded=!1),f.value.forEach(o=>e[o].expanded=!1)};return M({show:I}),(e,o)=>{const c=Q,y=P("Select"),s=W,w=X,_=Y,j=Z,z=ee,S=oe,L=ne,O=U("has");return T(),V(L,{modelValue:r(d),"onUpdate:modelValue":o[3]||(o[3]=v=>G(d)?d.value=v:null),title:"菜单功能权限",size:"700","before-close":k},{footer:n(()=>[a(S,null,{default:n(()=>[r($)?F("",!0):q((T(),V(w,{key:0,type:"primary",onClick:o[0]||(o[0]=v=>B())},{default:n(()=>[a(s,null,{default:n(()=>[a(y)]),_:1}),ae]),_:1})),[[O,"role:auth"]]),a(z,{style:{"margin-right":"20px","margin-left":"20px"},size:"default"},{dropdown:n(()=>[a(j,null,{default:n(()=>[a(_,{onClick:o[1]||(o[1]=v=>r(l).setCheckedKeys(r(h)))},{default:n(()=>[u("全部勾选")]),_:1}),a(_,{onClick:o[2]||(o[2]=v=>r(l).setCheckedKeys([]))},{default:n(()=>[u("取消勾选")]),_:1}),a(_,{onClick:g},{default:n(()=>[u("展开目录")]),_:1}),a(_,{onClick:R},{default:n(()=>[u("展开全部")]),_:1}),a(_,{onClick:A},{default:n(()=>[u("合并全部")]),_:1})]),_:1})]),default:n(()=>[a(w,null,{default:n(()=>[u("节点操作")]),_:1})]),_:1}),a(w,{onClick:k},{default:n(()=>[u("关 闭")]),_:1})]),_:1})]),default:n(()=>[a(c,{ref_key:"tree",ref:l,"node-key":"id",data:r(i),"default-checked-keys":r(m),"expand-on-click-node":!1,props:{class:b},"show-checkbox":"","check-on-click-node":""},null,8,["data","default-checked-keys","props"])]),_:1},8,["modelValue"])}}};export{ie as default};
